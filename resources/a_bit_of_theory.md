> Список терминов: [Атомарный (atomic)](/resources/glossary.md?id=Атомарный-atomic), [Денормализация (denormalization)](/resources/glossary.md?id=Денормализация-denormalization), [Долговечнось (durable)](/resources/glossary.md?id=Долговечнось-durable), [Изолированный (isolated)](/resources/glossary.md?id=Изолированный-isolated), [Нормальная форма (normal form)](/resources/glossary.md?id=Нормальная-форма-normal-form)

# Немного теории
Отношения между сущностями обычно характеризуются как:

## Отношение один-к-одному (one-to-one)
Данный тип связи используют не часто. В этом случае объекту одной сущности можно сопоставить только один объект другой сущности. Например, на некоторых сайтах пользователь может иметь только один блог. То есть возникает отношение один пользователь - один блог.

Нередко этот тип связей предполагает разбиение одной большой таблицы на несколько маленьких. Основная родительская таблица в этом случае продолжает содержать часто используемые данные, а дочерняя зависимая таблица обычно хранит данные, которые используются реже.
Например в дополнение к таблице пользователей может быть создана отдельная таблица с данными паспорта. Между этими таблицами так же будет установлена связь один-к-одному (у каждого пользователя может быть только один паспорт, и у каждого паспорта - один владелец)

<img src="./assets/one-to-one-erd.svg" alt="Диаграмма один-к-одному" style="max-width:100%; height:auto;">

В этом отношении первичный ключ зависимой таблицы в то же время является внешним ключом, который ссылается на первичный ключ из главной таблицы.

## Отношение один-ко-многим (one-to-many)
Это наиболее часто встречаемый тип связей. В этом типе связей несколько строк из дочерний таблицы зависят от одной строки в родительской таблице. Например, в одном блоге может быть несколько статей. В этом случае таблица блогов является родительской, а таблица статей - дочерней. То есть один блог - много статей. Или другой пример, в футбольной команде может играть несколько футболистов. И в то же время один футболист одновременно может играть только в одной команде. То есть одна команда - много футболистов.

<img src="./assets/one-to-many-erd.svg" alt="Диаграмма один-ко-многим" style="max-width:100%; height:auto;">

## Отношение многие-ко-многим (many-to-many)
Отношение многие-ко-многим описывает отношение, при котором несколько экземпляров одной модели связаны с несколькими экземплярами другой модели. Реальный пример: сообщение может иметь множество тегов, и каждый тег связан со многими сообщениями. Для этой связи обычно требуется третья таблица, известная как таблица соединений, для управления связями между двумя таблицами. Эта объединяющая таблица содержит внешние ключи, которые ссылаются на первичные ключи обеих таблиц, участвующих в связи. Отношения многие-ко-многим часто встречаются в реляционных базах данных при моделировании сложных сценариев реального мира, где сущности могут иметь несколько отношений с другими сущностями.

В качестве примера можно привести отношение между студентами и курсами учебного заведения. Любой студент может заниматься на множестве курсов, так же как и на каждом курсе может заниматься множество студентов.  Такое отношение реализуется в базе данных тремя таблицами: `students`, `courses` и `student_courses`:

<img src="./assets/many-to-many-erd.svg" alt="Диаграмма многие-ко-многим" style="max-width:100%; height:auto;">

<!-- #316896 > #42b983 -->

## ACID (Atomicity, Consistency, Isolation, Durability)

ACID — это набор свойств транзакций базы данных, гарантирующих надежность и целостность данных при операциях с ними. Аббревиатура ACID расшифровывается как:

- Atomicity (Атомарность): гарантирует, что транзакция будет выполнена целиком или не будет выполнена вовсе. Недопустимы частичные изменения данных. Если в процессе выполнения транзакции происходит ошибка, все изменения, которые успели произойти, отменяются, и база данных возвращается в исходное состояние. Это похоже на неделимую операцию: либо всё, либо ничего.
- Consistency (Согласованность/Непротиворечивость): гарантирует, что транзакция переводит базу данных из одного согласованного состояния в другое. Согласованное состояние означает, что данные в базе соответствуют всем заданным правилам и ограничениям (например, ограничениям целостности, уникальности и т. д.). Если транзакция нарушает какое-либо из этих правил, она отменяется.
- Isolation (Изолированность): гарантирует, что параллельные транзакции не влияют друг на друга. Каждая транзакция выполняется так, как будто она является единственной, работающей с базой данных в данный момент. Это предотвращает возникновение ошибок, связанных с одновременным доступом и изменением данных разными транзакциями. Существуют различные уровни изоляции, определяющие степень защиты от таких ошибок.
- Durability (Стойкость/Надежность): гарантирует, что результаты успешно завершенной транзакции сохраняются в базе данных и не будут потеряны в случае сбоя системы (например, отключения питания). Обычно это достигается путем записи изменений на энергонезависимый носитель (например, жесткий диск).

Простыми словами: ACID гарантирует, что любая операция с базой данных будет выполнена надежно и безопасно. Если вы, например, переводите деньги с одного счета на другой, ACID гарантирует, что деньги будут списаны с первого счета и зачислены на второй, и что эта операция не будет прервана посередине из-за какой-либо ошибки, а так же что результаты этой операции будут сохранены и не потеряются.

## Нормализация

- Нормализация — это процесс организации данных в базе данных.
- Цель: уменьшить дублирование и избежать аномалий.
- Первая нормальная форма (1NF): каждое поле каждой записи содержит одно неделимое значение.
- Вторая нормальная форма (2NF) и третья нормальная форма (3NF): каждое значение в записи, которое не является ключом, зависит исключительно от ключа, а не от других значений.
- Денормализация: явное хранение значений, которые можно было бы вычислить на лету, чтобы упростить запросы и/или ускорить обработку.
